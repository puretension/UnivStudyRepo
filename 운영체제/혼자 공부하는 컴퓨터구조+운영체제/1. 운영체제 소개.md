# 1. 운영체제 소개
[혼자 공부하는 컴퓨터구조+운영체제(저자 강민철)](https://www.yes24.com/Product/Goods/111378840)과 [유튜브 강의](https://www.youtube.com/watch?v=isj4sZhoxjk&list=PLYH7OjNUOWLUz15j4Q9M6INxK5J3-59GC&index=2)를 보고 정리한 글입니다. 
내용 하단부에는 관련 면접문항으로 정리합니다.

### 커널(kernel)

- 운영체제의 핵심 서비스를 담당함
- 운영체제가 설치된 모든 기기에는 커널이 존재
- 어떤 커널을 사용하는지에 따라 응용 프로그램이 하드웨어를 이용하는 방법이 달라지고, 컴퓨터의 성능도 달라지게됨

Quiz. 운영체제에는 속하는데 커널에는 속하지 않는 기능은? → `User Interface`

why? UI는 사용자와 컴퓨터간의 통로일 뿐 운영체제의 핵심 기능은 커널이 아님

### 사용자 인터페이스(UI, User Interface)

운영체제가 제공하는 서비스 중 커널에는 포함되지 않는 서비스
사용자가 컴퓨터와 상호작용할 수 있는 통로로 윈도우 바탕화면을 예로 들 수 있다.
사용자 인터페이스에는 그래픽 유저 인터페이스(GUI)와 커맨드라인 인터페이스(CLI)가 있다

- 그래픽 유저 인터페이스 - 그래픽을 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스
- 커맨드라인 인터페이스 - 명령어 기반으로 컴퓨터와 상호작용할 수 있는 인터페이스

## 이중 모드와 시스템 호출

사용자가 실행하는 프로그램은 자원에 직접 접근이 가능한가? NO! 자원에 직접접근은 위험함

`응용프로그램`들이 `자원`에 접근하려면 **운영체제의 도움**(운영체제의 코드 실행)은 필수적임

응용 프로그램의 하드디스크 접근은 **이중 모드**로 이뤄진다

### 이중 모드(dual mode)

- 이중모드란 CPU가 명령어를 실행하는 모드를 크게 `사용자 모드`와 `커널 모드`로 구분하는 방식
- 사용자 모드(user mode)
    - 운영체제 서비스를 제공받을 수 없는 실행 모드
    - 커널 영역의 코드를 실행할 수 없는 실행 모드
    - 자원 접근 불가
- 커널 모드(kernel mode)
    - 운영체제의 서비스를 제공받을 수 있는 실행모드
    - 자원접근을 비롯한 모든 명령어 실행가능

![스크린샷 2024-03-05 오후 3 39 31](https://github.com/puretension/UnivStudyRepo/assets/106448279/2ce1a6bd-6bbb-45a8-954b-ca6d01126bd3)

### 그렇다면 언제 커널모드로 바뀌고, 언제 사용자모드로 바뀔까? 판단기준은 무엇인가?

### 시스템 호출(system call)

- 시스템 호출이란 운영체제 서비스를 제공받기 위해 커널모드로 전환하는 방법
- 커널 모드로 전환하여 실행하기 위해 호출
- 일종의 소프트웨어 인터럽트(Interrupt)
    - 시스템 호출 처리방식은 하드웨어 인터럽트 처리방식과 유사함

시스템 호출 과정(그림이 쉽다)

1. 응용 프로그램이 운영체제에 **System Call**

2. CPU는 지금까지의 응용프로그램 작업을 **백업 및 커널 모드**로 전환

3. 커널 영역 내 시스템 호출을 수행하는 코드 (인터럽트 서비스 루틴) 실행

4. 사용자 모드 전환 후 기존에 실행하던 응용프로그램으로 복귀 및 실행 재개

![스크린샷 2024-03-05 오후 3 40 16](https://github.com/puretension/UnivStudyRepo/assets/106448279/892ef9c0-26c4-4830-832b-85cc28e4ce37)

## 운영체제의 핵심 서비스

- 프로세스 관리
- 자원접근 할당
- 파일 시스템 관리

### 프로세스 관리

- 프로세스 → 실행중인 프로그램
- 수많은 프로세스들은 동시에 실행
- 동시다발적으로 생성/실행/삭제되는 다양한 프로세스들을 일목요연하게 관리
- 프로세스, 스레드, 프로세스 동기화, 교착상태 해결

### 자원 접근 및 할당

- CPU (CPU 스캐쥴링: 어떤 프로세스들을 먼저, 얼마나 오래 실행할까?)
- 메모리(페이징, 스와핑,…)
- 입출력장치

### 파일 시스템 관리

- 관련 정보를 파일이라는 단위로 저장장치에 보관
- 파일들을 묶어 폴더(directory) 단위로 저장장치에 보관

-----------

## 시스템 콜과 인터럽트 면접 문항
- 시스템 콜이 무엇인지 설명해 주세요.
- 우리가 사용하는 시스템 콜의 예시를 들어주세요.
- 시스템 콜이, 운영체제에서 어떤 과정으로 실행되는지 설명해 주세요.
- 시스템 콜의 유형에 대해 설명해 주세요.
- 운영체제의 Dual Mode 에 대해 설명해 주세요.
- 왜 유저모드와 커널모드를 구분해야 하나요?
- 서로 다른 시스템 콜을 어떻게 구분할 수 있을까요?


### 시스템 콜이란?

시스템 콜(System Call)은 사용자 프로그램이 운영 체제의 커널에게 서비스를 요청할 수 있게 하는 인터페이스입니다. 프로그램이 하드웨어 자원에 접근하거나, 복잡한 작업을 요청할 때 사용합니다. 시스템 콜을 통해 파일 생성, 프로세스 관리, 네트워킹 등의 기능을 안전하게 사용할 수 있습니다.

### 시스템 콜의 예시

- `open()`: 파일을 열 때 사용합니다.
- `read()`, `write()`: 파일에서 데이터를 읽거나 파일에 데이터를 쓸 때 사용합니다.
- `fork()`: 새로운 프로세스를 생성할 때 사용합니다.
- `exec()`: 새로운 프로그램을 실행할 때 사용합니다.
- `wait()`: 프로세스가 종료될 때까지 기다릴 때 사용합니다.

### 시스템 콜의 실행 과정

1. 사용자 프로그램이 시스템 콜 함수를 호출합니다.
2. 시스템 콜 번호와 필요한 인자가 레지스터에 설정됩니다.
3. 프로그램이 트랩(trap) 명령을 실행하여 커널 모드로 전환합니다.
4. 운영 체제가 시스템 콜 번호를 확인하고 해당하는 서비스 루틴을 실행합니다.
5. 요청된 서비스가 처리된 후, 제어가 다시 사용자 프로그램으로 반환되고, 사용자 모드로 전환됩니다.

### 시스템 콜의 유형

1. **프로세스 제어**: 프로세스 생성, 종료, 실행 제어 등
2. **파일 조작**: 파일 생성, 삭제, 읽기, 쓰기 등
3. **장치 관리**: 장치 요청, 장치 방출, 장치 읽기, 쓰기 등
4. **정보 유지**: 시간 조회, 시스템 데이터 설정 및 조회 등
5. **통신**: 메시지 전송, 메시지 수신 등
6. **보호**: 권한 확인 및 설정 등

### 운영체제의 Dual Mode

운영 체제의 듀얼 모드(Dual Mode)는 시스템의 보안과 안정성을 위해 사용자 모드(User Mode)와 커널 모드(Kernel Mode)를 구분합니다. 사용자 모드에서는 제한된 접근 권한을 가지며, 커널 모드에서는 운영 체제가 전체 시스템 자원에 접근할 수 있습니다.

### 유저모드와 커널모드의 구분 필요성

- **보안**: 사용자 프로그램이 시스템의 중요한 자원에 임의로 접근하는 것을 방지합니다.
- **안정성**: 잘못된 프로그램의 실행으로부터 시스템 전체를 보호합니다.
- **효율성**: 커널 모드에서만 시스템 자원을 관리하므로, 자원 사용을 효율적으로 관리할 수 있습니다.

### 서로 다른 시스템 콜의 구분 방법

시스템 콜은 각각 고유한 번호(system call number)를 가지고 있습니다. 운영 체제는 이 번호를 통해 각 시스템 콜을 구분하고, 해당하는 커널 함수를 실행합니다. 사용자 프로그램은 시스템 콜 인터페이스(API)를 통해 이러한 번호를 직접 다루지 않고, 필요한 시스

템 콜을 호출합니다.

### 2. 인터럽트가 무엇인지 설명해 주세요.
- 인터럽트는 어떻게 처리하나요?
- Polling 방식에 대해 설명해 주세요.
- HW / SW 인터럽트에 대해 설명해 주세요.
- 동시에 두 개 이상의 인터럽트가 발생하면, 어떻게 처리해야 하나요?

### 인터럽트 처리 방법

인터럽트는 CPU가 현재 수행 중인 작업을 잠시 중단하고, 발생한 이벤트(하드웨어 신호 또는 소프트웨어 요청)를 처리한 뒤 원래의 작업으로 돌아가는 메커니즘입니다. 인터럽트 처리 과정은 다음과 같습니다:

1. **인터럽트 발생**: 하드웨어 장치 또는 소프트웨어에서 인터럽트 신호를 CPU에 전달합니다.
2. **현재 상태 저장**: CPU는 현재 실행 중인 작업의 상태(레지스터, 프로그램 카운터 등)를 저장합니다.
3. **인터럽트 서비스 루틴(ISR) 실행**: CPU는 인터럽트 벡터를 사용하여 해당 인터럽트를 처리할 인터럽트 서비스 루틴의 주소를 찾고, 그 루틴을 실행합니다.
4. **상태 복원 및 실행 재개**: 인터럽트 처리가 완료되면, 저장된 상태를 복원하고 중단된 작업을 계속 실행합니다.

### Polling 방식

Polling(폴링) 방식은 CPU가 주기적으로 I/O 장치의 상태를 체크하여 작업을 수행할 준비가 되었는지 확인하는 방법입니다. 특정 조건이 만족될 때까지 CPU는 계속해서 장치의 상태를 검사(poll)합니다. 폴링 방식은 실시간으로 장치의 상태를 확인할 수 있지만, CPU 자원을 비효율적으로 사용할 수 있는 단점이 있습니다.

### HW / SW 인터럽트

- **하드웨어 인터럽트**: 외부 장치(키보드, 마우스, 네트워크 카드 등)로부터 발생하는 인터럽트로, 장치의 상태 변화나 외부 이벤트에 의해 발생합니다. 하드웨어 인터럽트는 CPU에 직접 신호를 전달하여 반응을 요청합니다.
- **소프트웨어 인터럽트**: 프로그램 내부에서 발생하는 인터럽트로, 주로 시스템 콜이나 예외 상황에서 사용됩니다. 소프트웨어 인터럽트는 특정 명령어를 실행함으로써 CPU에 의도적으로 인터럽트를 발생시킵니다.

### 동시에 두 개 이상의 인터럽트 발생 시 처리 방법

동시에 여러 인터럽트가 발생한 경우, 인터럽트 컨트롤러는 우선순위를 기반으로 인터럽트를 순차적으로 처리합니다. 우선순위가 높은 인터럽트부터 처리되며, 낮은 우선순위의 인터럽트는 대기 상태로 유지됩니다. 우선순위 결정 방식은 하드웨어 설계나 운영 체제에 따라 다를 수 있습니다. 일부 시스템에서는 우선순위를 동적으로 조정하여 더 유연한 인터럽트 처리가 가능합니다. 처리가 완료된 인터럽트는 다음 우선순위의 인터럽트 처리를 위해 제거되고, 이 과정이 모든 인터럽트가 처리될 때까지 반복됩니다.
